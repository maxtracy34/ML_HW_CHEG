#!/usr/bin/env python
# coding: utf-8

# Hello ChemE's
# 
# Welcome!
# 
# Below is a script in python
# 
# We are using the jupyter notebook so you dont need to install any packages and solvers etc.
# 
# The script does the following
#     - Divide the data into k groups
#     - for each fold
#         - Learn an mlp neural network on the all data except the kth fold
#         - Display the error and artiy plot compared to the kth fold
#         
# What data is being used?
#     - The data is from a counter current heat exchanger
#     
# What do you have to do?
#     In the main function on the top, there are 2 parameters, k and n. Your jobs is to change k and n (using only the values shown) and observe how the fit and error changes. 
#     
# Complete all questions in the associated pdf and thats it!
# 
# Good luck!

# In[1]:


#Homework for students on ML



def main():
    #Helllo
    #You will only be asked to change the depth of the neurel network and the number of folds
    #do not touch anything else
    
    inputvalues = indata()
    outputvalues = outdata()
    k = 2       # Enter your number of prefered cross validation folds (2,4, or 5 only)
    n = 100      # depth of neurel network (anywhere from 1 to 100, must be an integer)
    NeurelNet(inputvalues,outputvalues,k,n)




# DO NOT TOUCH ANYTHING BELOW THIS LINE!

def outdata():
    return[124.95035171596544, 266.9541277336668, 34.774002945577685, 143.0303253983099, 245.9896152054247, 714.2998544676796, 319.53428867433115,
           137.632866192478, 446.4659529665929, 91.31088470849802, 38.530232611722084, 103.44192829873644, 46.016455671129634, 353.07695687080553,
           28.443599556524088, 54.08778554069264, 283.6574287676655, 434.8378788349824, 269.55198563720944, 325.71215828898494, 72.26594908791752,
           237.03036195878244, 83.1696695792648, 89.02968988267395, 338.52570176381784, 50.94723903977204, 101.61963912410685, 186.6011439740455,
           248.26094637555948, 340.606012961975, 33.26761311698171, 990.2109791742863, 243.70368855558695, 125.98836225409968, 286.31925114715966,
           202.04651722231935, 188.823280158216, 49.33068664998046, 69.86213073873135, 26.040304392850036, 88.68876896448471, 85.3246526520892,
           250.0164369943861, 256.08412616899966, 90.16731081874444, 304.5920264349137, 171.89888252263802, 41.49919991697487, 57.50747882928495,
           72.28356126499536, 329.7802747683717, 155.34437050005292, 159.9727416077182, 393.2492004570402, 380.4740801212173, 186.40116815131938,
           253.8767958977593, 615.6493294380391, 90.05804806761036, 198.87276571542176, 419.5619437521817, 172.88541253893374, 46.697274883838766,
           155.51900466241398, 232.5667903602796, 111.74981460276915, 61.667206686333344, 145.69378450280104, 463.82231330383036, 208.51771621647504,
           103.77808171518527, 194.61028872673364, 198.8881271958888, 53.751719915807556, 111.57493609944545, 313.697212991855, 180.10079247540247,
           118.58562685508468, 215.2542913900838, 26.677982700197834, 335.33897939197254, 326.3764229498871, 411.94781459307484, 159.9434525345377,
           86.23153067776813, 78.89978803024617, 52.41355642025016, 110.85354497492443, 260.96674062894346, 147.3943317875181, 36.18491111415874,
           240.64349707136662, 229.34342123256826, 157.25004937858884, 79.34137014940694, 163.91706199537782, 269.9197239184292, 179.4092128143096,
           89.73259219419221, 213.08482848397927]

def indata():
    return [[0.04007372149166915, 0.05727047098988795, 0.6110292114687833, 0.24621327441648033, 99.76247872036953, 37.10734664080323, 53.678579212918834],
            [0.02070651781743555, 0.04729160066627511, 0.7123026198023638, 0.30316847872481867, 84.73327764808934, 24.26587444830612, 57.09219987964111],
            [0.030094405298344278, 0.043110619203409986, 0.3729253265239192, 0.10909340596189812, 62.880511014215166, 40.3637061224317, 53.51363165254008],
            [0.023426666208636867, 0.05290363703458967, 0.6170956218117111, 0.23460800473257876, 63.72953266535805, 21.812425746967893, 54.50375387796117],
            [0.047972539648546704, 0.07716793269420978, 0.681169105114345, 0.35099995457516164, 111.37105143667947, 39.67062676146218, 57.68435226746001],
            [0.013052745311424401, 0.04068311924216998, 0.595835324000423, 0.2842906662421758, 103.9557814434378, 30.69325142105163, 52.64329153968705],
            [0.016917805849497217, 0.0468039010371607, 0.5908187946015402, 0.12860148523715048, 98.90224585741103, 27.43416623874237, 53.32956866422294],
            [0.029355356744237435, 0.05399796725683309, 0.42792181384559513, 0.23781632422303578, 86.04218272245971, 36.4203882446234, 58.75097859555914],
            [0.022169939027175727, 0.0417041272956195, 0.6709218487893102, 0.3544143749637726, 78.85981510247557, 40.368887592089926, 50.730567573148804],
            [0.04094749763383005, 0.05988914538977116, 0.7552639587603961, 0.2942750779678974, 83.28111226283181, 29.015310724691048, 57.31523821140285],
            [0.04038097920823653, 0.05158251737404776, 0.3759020547713303, 0.2562747916530017, 74.46408270563774, 21.440176337828007, 51.088500457350825],
            [0.03773425129287174, 0.05944455155925077, 0.5593508708046966, 0.4050680880023051, 69.08386600981471, 34.42054256829996, 58.037660780775106],
            [0.03345859186546608, 0.045712060020508864, 0.6344761704992808, 0.13517039406503772, 72.07021527816606, 33.28591568825353, 50.09566694253795],
            [0.023443787219466404, 0.05219111460497245, 0.5280891657239447, 0.3586576051693886, 88.67652879141883, 21.521764795677935, 56.43779866666301],
            [0.04713343204454543, 0.06566078232235023, 0.43019796741866134, 0.10125118349212148, 86.35087891001236, 26.58280068865448, 57.795373418130815],
            [0.034216420759038156, 0.049136156850955424, 0.6105291750850238, 0.18767250642639421, 80.28821253110253, 26.317352950282284, 55.50758571805691],
            [0.015665016827678447, 0.029289977191727712, 0.7668764970585936, 0.4448480512797387, 69.93294512658366, 20.48915108274353, 50.36688929617273],
            [0.026740381136060504, 0.0547748951790247, 0.9056361738890405, 0.43216386587377853, 110.69438033242123, 31.547073243023107, 58.7632612365546],
            [0.015866507783775907, 0.042904562253642725, 0.878984214923415, 0.4409149290675679, 62.786575315142656, 29.12156232745303, 57.90602326223351],
            [0.01798582414517212, 0.03199664048866537, 0.8272893223449767, 0.3992398912588908, 101.22625987273254, 41.86207878311202, 57.08205620805417],
            [0.045570501443139205, 0.061188229956749884, 0.7000571720632586, 0.4324248751470765, 74.42042570610053, 19.782754897237798, 56.381173475036576],
            [0.03348780914374249, 0.05969642309160508, 0.6495357772134724, 0.4019988009187704, 86.67288082826455, 21.9351458119514, 54.95917628247736],
            [0.04858048870434071, 0.06249859402998216, 0.6520285031249436, 0.41547159127391164, 78.61238450995363, 32.0871286469137, 57.6912886995327],
            [0.044955403066434, 0.06147291441270934, 0.4766389760104812, 0.35578683485961127, 73.85773134706328, 28.049064168143477, 50.028314653498484],
            [0.018150965561848476, 0.0382082400484568, 0.9048633716396643, 0.47877622072719306, 75.55330486265375, 33.555552681263606, 54.569366566204714],
            [0.041489243101502975, 0.062073029781988365, 0.5358461425112092, 0.14790781229500505, 78.46701524489801, 35.28092314351023, 59.69466320452322],
            [0.038201820327711127, 0.058410334341043466, 0.6008727710878762, 0.3130940215930633, 73.51771773504636, 41.48686802126583, 55.41406753542582],
            [0.024383247690889287, 0.05204788597357245, 0.7644885665083261, 0.39994072765351085, 69.96524116167818, 28.66215254313852, 56.96294434453782],
            [0.021431572841785505, 0.04445056822111407, 0.4813484975099249, 0.367820204725247, 83.48985725083776, 26.48135619954723, 58.97708989699385],
            [0.03494229266175665, 0.05760089176185389, 0.47984586476618063, 0.29516734011446016, 101.67462966394748, 40.121678116101634, 50.94734710458506],
            [0.04911333904924302, 0.07296980618287638, 0.3058727730413098, 0.12467743531297192, 70.20572976815272, 27.18388483975257, 52.717637736471495],
            [0.014241052415104845, 0.039420532504006456, 0.7819603989543301, 0.42208351634680574, 94.57519907610344, 32.21113908683915, 53.99476063453611],
            [0.04926528301025485, 0.07490976241077688, 0.5966090556077672, 0.4697189666297974, 89.34211468370037, 23.27896501733184, 57.077856105211595],
            [0.01816431315669412, 0.046830189455738774, 0.4756654926672992, 0.1480120046015581, 69.9038169706258, 36.52098920514542, 55.89468523408087],
            [0.024996733384075306, 0.04719432393109679, 0.5151925547307362, 0.31020195787460103, 69.2855474212918, 21.7530211312802, 51.785876699082365],
            [0.028829661083356377, 0.04827894824219736, 0.9121728953842995, 0.43085047803660437, 73.25266352571984, 34.63642513977085, 56.05783967544477],
            [0.047458148945257704, 0.07724311963561367, 0.7827794729710769, 0.460535053906735, 79.05871624393497, 34.0220284265178, 56.0702638973298],
            [0.036023636601935874, 0.04879290966965298, 0.5427425905614411, 0.41552174523830065, 84.8320164350395, 22.93506049212735, 58.30588312194385],
            [0.027683968941858796, 0.04200330033175197, 0.40807455349796007, 0.1759613413476457, 83.63271261234745, 32.73474930925147, 59.2019517881804],
            [0.04027918381439791, 0.052527482916430404, 0.4015932744959936, 0.15588570572917815, 97.4602642981343, 26.2000142063549, 57.54610046893173],
            [0.048040550598659255, 0.0634285926220064, 0.8095352225561067, 0.4193114402497723, 77.9998807746339, 33.138411703135304, 52.54983398656523],
            [0.025511083155662986, 0.04035084350339269, 0.6865650233606952, 0.3073044262438853, 77.6965732276857, 27.19166718809082, 57.54282969995187],
            [0.02547992258826254, 0.05185308812414234, 0.4966387000210569, 0.2804326868627252, 98.90427227487096, 21.558601518834124, 50.16585028791288],
            [0.04260219542112873, 0.06458713274356624, 0.7085673208572701, 0.47018800266209315, 100.3974798029357, 45.095469732394555, 59.90989275051207],
            [0.04479183399319675, 0.06279586575126107, 0.35216196591338644, 0.2154430069519628, 111.92390266480733, 33.46134828971997, 57.140603853052625],
            [0.033058073409637484, 0.04889993874016284, 0.8407801783702883, 0.41721494003364834, 94.10546452660098, 37.23280157138754, 52.60620279954543],
            [0.02837843998080406, 0.039058748127919034, 0.9209506967709181, 0.48551153409576364, 95.96818730113738, 26.913753207783508, 55.150455268863546],
            [0.04437848553754799, 0.061744633108626, 0.3998361623071156, 0.1070842559726859, 90.3239548623333, 39.50441213089233, 54.58964850208086],
            [0.02573594937093609, 0.038079056643121514, 0.5112047825912587, 0.326176256097071, 59.76359043727234, 19.531129915506888, 54.62091138362676],
            [0.03259584138195002, 0.05631683947993841, 0.23185884464742082, 0.10755895573295358, 103.16104735711772, 29.809877904004708, 55.35581129113283],
            [0.028567109786497374, 0.04542695721556289, 0.7030645318768111, 0.44339722527506986, 104.49375177168933, 35.46688369335856, 52.225528332279566],
            [0.022828657255768686, 0.05231527396210799, 0.7125171460837019, 0.23150411725906295, 67.77204300729021, 28.002454219179914, 55.554077554108204],
            [0.0448986575087154, 0.06525601435514258, 0.6852730642572621, 0.41660559740581016, 104.00259590795694, 28.966622464406875, 53.07014275946807],
            [0.01819928818529854, 0.04814908755310403, 0.5646243308604094, 0.301628121163926, 78.22296416215653, 24.95886333666775, 55.41673433328331],
            [0.030358464074467788, 0.04981031376175517, 0.7457305658392704, 0.41408661671515545, 119.80737495097198, 36.22452821275287, 52.21992464010864],
            [0.01935653481497259, 0.02961646127862319, 0.4644012413202584, 0.19291974813405527, 107.55865027938508, 38.18077499029938, 50.59161310200008],
            [0.024432474283596767, 0.051765103756122914, 0.6720076783467737, 0.2570096203531054, 90.07215882214794, 41.47645208632286, 57.388050664700984],
            [0.020194467422789394, 0.046299832983077306, 0.4571907497453306, 0.33663377111703985, 83.75814287878971, 39.892026863607924, 54.51706391245136],
            [0.046374473276105076, 0.0761606755228623, 0.7519127491986156, 0.2654846040023148, 88.03205465598356, 26.088219723209434, 56.20869078788155],
            [0.03393986162979633, 0.06005767150688417, 0.6286397395068634, 0.46389362710712934, 81.5448453644753, 28.165352296005636, 54.014743544053474],
            [0.019994899299961066, 0.0449420800209797, 0.7085133941117119, 0.26898385341710085, 120.7739885321471, 34.03919058130021, 53.839298783775575],
            [0.036195944879126925, 0.05700046131445996, 0.5183635285334881, 0.2868533619963535, 104.3228997974538, 32.52564698889187, 54.61598625217246],
            [0.04151472093164821, 0.06421277953495556, 0.6048893731330143, 0.10556571356249425, 85.04789525609854, 26.687695744532128, 55.02832796149781],
            [0.02598134759295133, 0.037989609299904796, 0.8665894367133019, 0.3754674690106815, 92.61514214711354, 34.657933713314115, 59.201333439536995],
            [0.015900155332503597, 0.0325506888103814, 0.8247772162363735, 0.37467263932343975, 83.65542404120332, 23.4935252900424, 50.182891226962255],
            [0.03601649115940741, 0.06388382424497031, 0.5311732658590143, 0.18596468684191647, 71.96618747592717, 32.8118157674512, 54.63890666438675],
            [0.04692946843645631, 0.06066750233791049, 0.5629465667350202, 0.4003983588076854, 74.30776238594768, 19.497624772450106, 51.53730091317319],
            [0.03005290650405741, 0.04769373548532649, 0.5940907150045894, 0.303072710215043, 89.38253733404397, 24.54583793211786, 58.928862416445995],
            [0.024680556203294082, 0.05421605861885249, 0.692181255233328, 0.46778670104296105, 83.73976266881765, 33.95142652242554, 58.56552378134484],
            [0.012479892815107424, 0.028998034673998432, 0.5736669147174976, 0.1943352625578858, 128.04702083210123, 20.081534640284133, 59.42785187361988],
            [0.04174931464200135, 0.06264193787174632, 0.5862636072517816, 0.1790054345844109, 134.28377723544904, 28.16238150912023, 52.91195036521879],
            [0.040280982563493085, 0.06629044639872103, 0.9456595086018688, 0.4494203289222093, 92.22284285836253, 24.044775052436556, 52.5527109638612],
            [0.01872784484515034, 0.03171201522453611, 0.44532258009414016, 0.28956054480034515, 89.43589413051181, 25.62049220026082, 50.26799735950411],
            [0.036921285211883856, 0.05601562611180809, 0.40104071727742685, 0.13273668234700448, 80.79330401357174, 30.37631388885928, 57.74648570040938],
            [0.04551157721235713, 0.07096993935718528, 0.552824892270648, 0.32399413717707926, 90.95012314103839, 23.143166638011653, 54.950005670867775],
            [0.040278728178653966, 0.06878197355512317, 0.8392167845834715, 0.41768775691335025, 98.0056811663495, 34.49910969891381, 51.804301546524606],
            [0.01348768513889969, 0.024339208356043848, 0.43987233456044394, 0.2998478850275039, 74.30516531809522, 25.70151983453957, 58.110558916567115],
            [0.03589655837012563, 0.057508085604018405, 0.5491973505010148, 0.16552347291230088, 125.29862180494266, 29.38471399725499, 50.37562402658892],
            [0.016775061797441468, 0.046201475687354394, 0.29320312692645667, 0.135315881103686, 96.71653564723107, 22.034857128132366, 51.28279868414205],
            [0.024031751633108823, 0.03429432736603938, 0.6121025307999257, 0.1310453965730953, 86.30543750165202, 18.706490327174087, 58.68827997234175],
            [0.02404075136638438, 0.04183246676065533, 0.7421410316842708, 0.426282848553873, 92.96336509606442, 42.1336466097703, 59.708865717771396],
            [0.0414400077465078, 0.06270142277652849, 0.5360994340159934, 0.4281426048007071, 115.98710349307564, 29.202882141606267, 50.29253106394561],
            [0.04022596356383129, 0.06088888778526715, 0.5728507163692219, 0.4588479892104893, 109.01877455953503, 34.37977352613162, 51.34868681779013],
            [0.03241673779962036, 0.052928161427736785, 0.883370981765932, 0.41941006170954787, 74.42653931730622, 30.24567948017533, 53.22770466221525],
            [0.023565360182626248, 0.04595024346154905, 0.8332385932938503, 0.34230729304402385, 76.11512697836882, 28.69888467977336, 59.15088981183875],
            [0.04133055890333591, 0.05929316441219578, 0.6332658318665112, 0.3347319516510426, 87.7223465683761, 25.574780630460623, 55.15895326779835],
            [0.045940885127835625, 0.0705888929098285, 0.550991794352143, 0.1519213629130511, 67.1225276656356, 33.57265815680107, 53.60730893463912],
            [0.045575618247671576, 0.06552178446482047, 0.6877035640505411, 0.31674135065332415, 76.01198798936684, 39.74171769744796, 54.23454326483309],
            [0.03384743004825493, 0.06208883581180266, 0.6897715517665851, 0.4327612019317624, 62.49024710732341, 30.115117593400306, 50.68783731305713],
            [0.02426574363986237, 0.04757646909779874, 0.4076469923868664, 0.13466821117985206, 95.19246933576164, 43.67874953310927, 55.566568923052245],
            [0.04199080568354383, 0.0567678450622775, 0.6018641093583531, 0.19527771146699457, 72.61896279425073, 24.93565353859689, 59.6259617939573],
            [0.04390337413722652, 0.06568335895136801, 0.6476948836017359, 0.38127064128678023, 111.11540539409874, 30.787860417302817, 50.341256794591054],
            [0.02060962769667138, 0.049753044527967964, 0.4311132152288235, 0.23788648826751746, 94.65577966200465, 21.132428186445118, 52.67709021858257],
            [0.035597901500593665, 0.058836092034033075, 0.7311735395518925, 0.40836571131326205, 84.1519946489191, 26.186985841093197, 53.912566371943996],
            [0.04523258518075968, 0.060957105423908475, 0.6535706816985504, 0.16551689622936078, 94.46768262140964, 42.500255661099104, 50.146498173704046],
            [0.01270092566767627, 0.026495503531835902, 0.5712992324863861, 0.16688148498738742, 71.86864718134677, 28.121513190370734, 51.5452010980312],
            [0.04571800360189128, 0.0728041652176542, 0.8614084351520375, 0.4352777438927541, 98.93776084224858, 40.661106206552795, 57.42930755474333],
            [0.039166988780715055, 0.06740588507548559, 0.8293689790865396, 0.4079665533346014, 82.68754598644756, 19.205578823794095, 52.54359660734415],
            [0.04737662426727346, 0.058174132187941714, 0.6994190206070842, 0.4546001719959797, 88.80709070854147, 42.08679334294314, 56.99865054799874],
            [0.043876191683135966, 0.06482401117409173, 0.9654522760285099, 0.46906662402674193, 100.70829302687181, 34.78076047511165, 52.16610776064059]]
   



def NeurelNet(InputData,OutputData,k,n):
    from sklearn import preprocessing
    import sklearn.neural_network as nn
    import numpy as np
    import matplotlib.pyplot as mp
    import statistics as sta
    get_ipython().run_line_magic('matplotlib', 'inline')
    SCALER = preprocessing.StandardScaler()
    SCALER.fit(InputData)
    InputData = SCALER.transform(InputData)
    if(k!=2 and k!=4 and k!= 8):
        print("Not a good fold number, try again")
        return
    if(n<1 or n>100 or n %1 != 0):
        print("Not a good depth, try again")
        return
    
    m = len(InputData)
    functions = []
    TestingSets =[]
    TestingOut = []
    for i in range(k):
        if(i==0):
            TestingInput = InputData[int((i/k)*m):int(((i+1)/k)*m)]
            TestingOutput = OutputData[int((i/k)*m):int(((i+1)/k)*m)]
            TrainingInput = InputData[int(((i+1)/k)*m):]
            TrainingOutput =  OutputData[int(((i+1)/k)*m):]
        elif(i==(k-1)):
            TestingInput = InputData[int((i/k)*m):int(((i+1)/k)*m)]
            TestingOutput = OutputData[int((i/k)*m):int(((i+1)/k)*m)]
            TrainingInput = InputData[0:int((i/k)*m)]
            TrainingOutput = OutputData[0:int((i/k)*m)]
        else:
            TestingInput = InputData[int((i/k)*m):int(((i+1)/k)*m)]
            TestingOutput = OutputData[int((i/k)*m):int(((i+1)/k)*m)]
            TrainingInput = InputData[0:int((i/k)*m)] + InputData[int(((i+1)/k)*m):]
            TrainingOutput = OutputData[0:int((i/k)*m)] + OutputData[int(((i+1)/k)*m):] 

        TestingOut.append(TestingOutput)
        TestingSets.append(TestingInput)
        newfun = nn.MLPRegressor(hidden_layer_sizes=(n,),max_iter=10000,tol=1)
        newfun.fit(TrainingInput,TrainingOutput)
        functions.append(newfun)
    
    if(k==2):
        rows = 2
        columns =1
    if(k==4):
        rows = 2
        columns = 2
    if(k==5):
        rows = 2
        columns =3
    number = rows*100+columns*10
    for i in range(len(functions)):
        
        Xmodel = []
        Xreal = TestingOut[i]
        Xmodel = functions[i].predict(TestingSets[i])
        error = []
        for j in range(len(Xreal)):
            error.append(abs(Xmodel[j]-Xreal[j]))
        print("XXXXX")
        print("For Fold Number " + str(i))
        print("The total error is " + str(sum(error)))
        print("The mean error is " + str(sta.mean(error)))
        print("The standard deviation of error is " + str(sta.stdev(error)))
        mp.subplot(number + i+1)
        mp.plot(Xmodel,Xreal,'ro',range(int(max(Xmodel))),range(int(max(Xmodel))))
        mp.title("Fold Number " + str(i))
    mp.subplots_adjust(top=0.92, bottom=0.08, left=0.10, right=0.95, hspace=0.25,
                    wspace=0.35)
    mp.show()




if __name__=="__main__":
    main()

